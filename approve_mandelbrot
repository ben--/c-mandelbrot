#!/bin/sh
set -e

expected_checksum() {
	echo "347a2e7441cf70ee1b4781946b5994ec36b8d865"
}

actual_checksum() {
	shasum "$1" | awk '{print $1}'
}

main() {
	expected=$(expected_checksum)
	actual=$(actual_checksum "$1")
	if [ $expected == $actual ]; then
		exit 0
	else
		echo >&2 "'$1' has changed! now it's..."
		echo >&2 $actual
		open "$1"
		exit 77
	fi
}

main "$@"
exit $?
